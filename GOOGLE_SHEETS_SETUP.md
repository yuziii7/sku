# Google Sheets 变体管理设置指南

## 概述

本指南将帮助您设置Google Sheets来管理SKU生成器的变体数据。您的Sheet ID是：`1bT2cXdcyx91esIfs3sIbq2lDUe1NVZ8LrHSwuAOZqag`

## 1. Google Sheets 结构设置

### 工作表结构（重要更新）

现在所有变体数据都存储在一个 **Colors** 工作表中，采用横向排列的方式：

- **颜色变体**：A-C列（ID、名称、代码）
- **动物变体**：D-F列（ID、名称、代码）
- **职业变体**：G-I列（ID、名称、代码）
- **幽默变体**：J-L列（ID、名称、代码）
- **角色变体**：M-O列（ID、名称、代码）

### Colors 工作表的列结构

| A | B | C | D | E | F | G | H | I | J | K | L | M | N | O |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 颜色ID | 颜色名称 | 颜色代码 | 动物ID | 动物名称 | 动物代码 | 职业ID | 职业名称 | 职业代码 | 幽默ID | 幽默名称 | 幽默代码 | 角色ID | 角色名称 | 角色代码 |
| 1 | 黑色 | BK | 1 | 猫 | CAT | 1 | 医生 | DOC | 1 | 搞笑 | FUN | 1 | 英雄 | HERO |
| 2 | 红色 | RD | 2 | 狗 | DOG | 2 | 老师 | TEA | 2 | 幽默 | HUM | 2 | 反派 | VILL |
| 3 | 蓝色 | BL | 3 | 鸟 | BRD | 3 | 工程师 | ENG | 3 | 讽刺 | SAR | 3 | 配角 | SUPP |

**重要说明：**
- 第1行是标题行，包含所有类别的列标题
- 每个类别占3列：ID、名称、代码
- 各类别的数据可以有不同的行数
- 空白单元格会被忽略

## 2. 示例数据

### Colors 工作表示例（横向结构）
```
A  B    C   D  E    F    G  H      I    J  K    L    M  N    O
ID 名称 代码 ID 名称 代码 ID 名称   代码 ID 名称 代码 ID 名称 代码
1  黑色 BK   1  猫   CAT  1  医生   DOC  1  搞笑 FUN  1  英雄 HERO
2  红色 RD   2  狗   DOG  2  老师   TEA  2  幽默 HUM  2  反派 VILL
3  橙色 OG   3  鸟   BRD  3  工程师 ENG  3  讽刺 SAR  3  配角 SUPP
4  黄色 YL   4  鱼   FSH  4  律师   LAW  4  机智 WIT  4  导师 MENT
5  绿色 GN   5  兔子 RAB  5  厨师   CHF  5  滑稽 SLY  5  学生 STUD
6  紫色 PL   6  熊   BER  6  艺术家 ART  6  诙谐 WHM  6  朋友 FRND
7    棕色   BN
8    蓝色   BL
9    青色   CY
10   粉色   PK
11   白色   WH
12   灰色   GY
13   金色   GD
14   银色   SV
```

### Animals 工作表示例
```
A    B      C
ID   名称   代码
1    恐龙   A001
2    独角兽 A002
3    龙     A003
4    蝴蝶   A004
5    蝙蝠   A005
6    鲨鱼   A006
7    章鱼   A007
8    兔子   A008
9    老鼠   A009
10   猫     A010
```

### Professions 工作表示例
```
A    B        C
ID   名称     代码
1    啦啦队   F001
2    FBI      F002
3    警察     F003
4    囚犯     F004
5    消防员   F005
6    摇滚     F006
7    啤酒节   F007
8    飞行员   F008
9    女郎     F009
10   帮派分子 F010
```

### Humor 工作表示例
```
A    B      C
ID   名称   代码
1    南瓜   H001
2    蘑菇   H002
3    老太太 H003
4    光头   H004
5    马桶   H005
6    找茬   H006
7    食物   H007
8    雪花   H008
9    毕业季 H009
10   彩虹   H010
```

### Roles 工作表示例
```
A    B        C
ID   名称     代码
1    女巫     C001
2    忍者     C002
3    丧尸     C003
4    死神     C004
5    骷髅     C005
6    鬼       C006
7    恶魔     C007
8    天使     C008
9    埃及     C009
10   亡灵     C010
```

## 3. Google API 设置

### 步骤1：创建Google Cloud项目
1. 访问 [Google Cloud Console](https://console.cloud.google.com/)
2. 创建新项目或选择现有项目
3. 记录项目ID

### 步骤2：启用Google Sheets API
1. 在Google Cloud Console中，转到"API和服务" > "库"
2. 搜索"Google Sheets API"
3. 点击启用

### 步骤3：创建API密钥
1. 转到"API和服务" > "凭据"
2. 点击"创建凭据" > "API密钥"
3. 复制生成的API密钥
4. （可选）限制API密钥只能访问Google Sheets API

### 步骤4：设置工作表权限
1. 打开您的Google Sheets文档
2. 点击右上角的"共享"按钮
3. 在"获得链接的任何人"部分，设置为"查看者"或"编辑者"
4. 确保链接共享已启用

## 4. 在SKU生成器中使用

### 步骤1：打开变体管理
1. 在SKU生成器页面中，点击"变体管理"标签
2. 在API密钥输入框中粘贴您的API密钥
3. 点击"连接"按钮

### 步骤2：同步数据
1. 连接成功后，点击"同步"按钮
2. 系统将从Google Sheets加载所有变体数据
3. 数据将自动更新到SKU生成器的选项中

### 步骤3：添加新变体
1. 在"添加新变体"部分选择类别
2. 输入变体名称和代码
3. 点击"添加变体"按钮
4. 新变体将自动添加到Google Sheets和本地缓存

## 5. 注意事项

### 安全性
- API密钥会保存在浏览器本地存储中
- 请不要在公共场所或不安全的网络中使用
- 定期更换API密钥以确保安全

### 数据同步
- 系统会自动缓存数据到本地存储
- 即使离线也可以使用缓存的数据
- 建议定期点击"同步"按钮获取最新数据

### 错误处理
- 如果连接失败，系统会使用本地缓存的数据
- 添加变体失败时，数据会保存到本地，下次同步时上传
- 所有操作都会记录在操作日志中

## 6. 故障排除

### 常见问题

**Q: 连接失败，显示403错误**
A: 检查API密钥是否正确，确保已启用Google Sheets API

**Q: 连接失败，显示404错误**
A: 检查Sheet ID是否正确，确保工作表已设置为公开访问

**Q: 数据同步失败**
A: 检查网络连接，确保工作表结构正确（包含ID、名称、代码列）

**Q: 添加变体失败**
A: 检查是否有编辑权限，确保API密钥有写入权限

### 联系支持
如果遇到其他问题，请检查浏览器控制台的错误信息，或查看操作日志获取详细信息。

## 7. 高级功能

### 批量导入
您可以直接在Google Sheets中批量添加数据，然后在SKU生成器中点击"同步"按钮更新。

### 数据备份
建议定期备份您的Google Sheets数据，可以通过"文件" > "下载" > "Excel (.xlsx)"进行备份。

### 多人协作
多个用户可以同时编辑Google Sheets，但建议指定专人负责数据管理，避免冲突。